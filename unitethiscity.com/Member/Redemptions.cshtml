@{
    Layout = "~/Shared/_Layout.cshtml";

    // create an unmanaged page
    Page.SitePage = new SiteWebPage();
    Page.SitePage.ApplyName("Social Deals");
    
    // make sure the user is logged in
    if ( !SiteAccount.IsLoggedIn() )
    {
        Response.Redirect(Href("~/AccountLogin"), false);
        return;
    }

    SiteMember siteMember = new SiteMember();

    List<SummaryStats> stats = siteMember.CalculateSummaryStats();
    SummaryStats stat = stats.Single(target => target.Name == Page.SitePage.Name);

    WebDBContext db = new WebDBContext();
    
    // build the webgrid for display
    IEnumerable<VwRedemptions> rs = (from rows in db.VwRedemptions where rows.AccID == siteMember.AccID orderby rows.RedTS descending select rows);
    WebGrid webGrid = new WebGrid(rs, rowsPerPage: Convert.ToInt32(SiteSettings.GetValue("DefaultPageSize")));    
}
	<!-- PAGE -->
	<div id="page">
        <!-- BREAD CRUMBS -->
        <div class="breadcrumbs Roles">
            <div class="breadcrumbGray"><a href="@Href( "~/Account/" )">Account Dashboard</a></div>
			<div class="breadcrumbEndGray">&nbsp;</div>
        </div>
		<div id="fullSide">
			<h1>@siteMember.AccFName @siteMember.AccLName: @Html.Raw( Page.SitePage.Heading )</h1>
            @Html.Raw( Page.SitePage.Body )

            <!-- DASHBOARD -->

            <!-- BUSINESS BOX  -->
            <div class="dashboardBusinessBox">
                <div class="dashboardBusinessImage"><img src="@SiteAccount.ActiveAvatarURL()" width="100" height="100" alt="" /></div>
                <div style="float:left; width:640px;margin-right:0px;">
                    <div style="text-align:center;">
                        <div style="background-color:white;margin-top:0px; padding:10px; border-radius:10px;height:80px;">
                            <div style="float:left;width:20%;margin-top:20px;margin-bottom:5px;">
                                <div style="font-size:14px;font-weight:bold;">Today</div>
                                <div style="font-size:24px;font-weight:bold;">@stat.Today</div>
                            </div>
                            <div style="float:left;width:20%;margin-top:20px;margin-bottom:5px;">
                                <div style="font-size:14px;font-weight:bold;">Past Week</div>
                                <div style="font-size:24px;font-weight:bold;">@stat.PastWeek</div>
                            </div>
                            <div style="float:left;width:20%;margin-top:20px;margin-bottom:5px;">
                                <div style="font-size:14px;font-weight:bold;">This Month</div>
                                <div style="font-size:24px;font-weight:bold;">@stat.ThisPeriod</div>
                            </div>
                            <div style="float:left;width:20%;margin-top:20px;margin-bottom:5px;">
                                <div style="font-size:14px;font-weight:bold;">Last Month</div>
                                <div style="font-size:24px;font-weight:bold;">@stat.LastPeriod</div>
                            </div>
                            <div style="float:left;width:20%;margin-top:20px;margin-bottom:5px;">
                                <div style="font-size:14px;font-weight:bold;">All-Time</div>
                                <div style="font-size:24px;font-weight:bold;">@stat.AllTime</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br style="clear:left;" />
            @RenderPage( "~/Shared/_MemberTabs.cshtml" )
            <h2>Social Deal Redemptions</h2>
            <div id="WebGridPanel" class="WebGrid">
                @webGrid.GetHtml(
                    columns: webGrid.Columns(
                    webGrid.Column("BusName", "Business",  format: @<text>@(item.BusName)</text>, style:"wgWidth35 wgLeft"),
                    webGrid.Column("PerName", "Month", format: @<text>@(item.PerName)</text>, style:"wgWidth15 wgCenter"),
                    webGrid.Column("RedTS", "Timestamp", format: @<text>@(item.RedTS.ToShortDateString()) - @(item.RedTS.ToShortTimeString())</text>, style:"wgWidth20 wgCenter"),
                    webGrid.Column("DelName", "Deal", format: @<text>@HttpUtility.HtmlEncode(item.DelName)</text>, style:"wgWidth20 wgLeft"),
                    webGrid.Column("DelAmount", "Amount", format: @<text>@item.DelAmount.ToString("C2")</text>, style:"wgWidth10 wgRight")
                ),
                    tableStyle: "WebGridTable",
                    headerStyle: "WebGridHeader",
                    rowStyle: "WebGridRow",
                    alternatingRowStyle: "WebGridRowAlt",
                    footerStyle: "WebGridFooter",
                    mode: WebGridPagerModes.All,
                    firstText: "First Page",
                    lastText: "Last Page",
                    numericLinksCount: 10,
                    emptyRowCellValue: "N/A"
                )
            </div>
		</div>
		<br style="clear:left;" />
	</div>